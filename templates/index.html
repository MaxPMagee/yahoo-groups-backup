{% extends "master.html" %}
{% set active_page = 'index' %}
{% block head %}
  <link href="https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css" rel="stylesheet">
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.3.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.js"></script>
  <style>
    td {
      word-break: break-all;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .highlight {
      background-color: #ffff7f;
    }
  </style>
{% endblock %}
{% block body %}
<div class="container">

  <div class="text-center">
    <h1>{{ group_name }} Yahoo! Group Backup</h1>
  </div>

  <div id="loading">
    <div class="text-center">
    <br>
    <p class="lead">Loading messages...</p>
    <img src="https://i1.wp.com/cdnjs.cloudflare.com/ajax/libs/galleriffic/2.0.1/css/loader.gif">
    </div>
  </div>
  <div id="table-container" style="display: none;">
  <table id="messages" class="table table-hover table-bordered" cellspacing="0" width="100%">
    <thead>
    <tr class="row">
      <th class="col-xs-4  col-sm-4 col-md-5 col-lg-6">Subject</th>
      <th class="col-xs-4  col-sm-3 col-md-3 col-lg-3">Author</th>
      <th class="col-xs-4  col-sm-3 col-md-3 col-lg-2">Date</th>
      <th class="hidden-xs col-sm-2 col-md-1 col-lg-1">#</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  </div>
  <br>

</div><!-- /.container -->

  <script type="text/javascript">
    /*var currentHighlight = null;

    function goToMessageNumber(number) {
      // NOTE, only works on unsorted/unfiltered table!
      var table = $('#messages').DataTable();

      // remove current highlight
      if (currentHighlight) {
        $(table.row(currentHighlight).nodes()).removeClass('highlight');
      }

      var index = table.column(4).data().indexOf(''+number);
      if (index === -1) {
        return;
      }

      currentHighlight = index;

      // add new highlight
      $(table.row(currentHighlight).nodes()).addClass('highlight');

      // go to page
      var page = Math.floor(currentHighlight / table.page.len());
      table.page(page).draw(false);
    }

    function updateSelectMessage() {
      var messageNumber = parseInt($("#select-message").val());
      goToMessageNumber(messageNumber);
    }

    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }*/

    $(document).ready(function() {
      // initialize table
      var table = $('#messages').DataTable({
        "order": [[ 3, "desc" ]],
        "dom":
           "<'row'<'col-sm-6'l><'col-sm-6'f>>" +
           "<'row'<'col-sm-5 go-to-message'><'col-sm-7'p>>" +
           "<'row'<'col-sm-12'tr>>" +
           "<'row'<'col-sm-5'i><'col-sm-7'p>>",
        "lengthMenu": [ [ 10, 25, 50, 100, 1000, 5000, -1 ], [ 10, 25, 50, 100, 1000, 5000, "All" ]],
        "pagingType": "simple_numbers",
        "ajax": function (data, callback, settings) {
          console.log("ajax called");
          callback({'data': [
            {"s":"Re: [actualfreedom] Letting the cat out of the bag - Here be perfection","a":"andrewactually","d":"Jun-19-16, 08:20 AM","i":22849},
            {"s":"Re: &#39;I&#39; really am rotten to the core","a":"srinathjellybaby","d":"Jun-19-16, 05:06 AM","i":22848},
            {"s":"Re: &#39;I&#39; really am rotten to the core","a":"Alan (alan_ji)","d":"Jun-19-16, 04:53 AM","i":22847},
            {"s":"Re: [actualfreedom] Letting the cat out of the bag - Here be perfection","a":"srinathjellybaby","d":"Jun-19-16, 04:52 AM","i":22846},
            {"s":"Re: [actualfreedom] Sincerity is the Key","a":"alan_ji","d":"Jun-19-16, 04:47 AM","i":22845},
            {"s":"Re: &#39;I&#39; really am rotten to the core","a":"srinathjellybaby","d":"Jun-19-16, 04:35 AM","i":22844},
            {"s":"Re: [actualfreedom] Letting the cat out of the bag - Here be perfection","a":"andrewactually","d":"Jun-19-16, 01:50 AM","i":22843},
            {"s":"Re: [actualfreedom] Letting the cat out of the bag - Here be perfection","a":"srinathjellybaby","d":"Jun-19-16, 01:08 AM","i":22842},
            {"s":"Re: [actualfreedom] The Legacy of Pragmatic Dharma","a":"Alan (alan_ji)","d":"Jun-18-16, 07:20 PM","i":22841},
            {"s":"Re: [actualfreedom] Sincerity is the Key","a":"hunterad93","d":"Jun-18-16, 03:54 PM","i":22840},
            {"s":"Re: [actualfreedom] Sincerity is the Key","a":"Claudiu (laxori666)","d":"Jun-18-16, 09:15 AM","i":22839},
            {"s":"Re: [actualfreedom] Sincerity is the Key","a":"Craig Nichols (myfragileego)","d":"Jun-18-16, 01:23 AM","i":22838}
          ]});
          console.log("callback returned");
        },
        "columns": [
          {"data": "s", "className": "col-xs-4  col-sm-4 col-md-5 col-lg-6"},
          {"data": "a", "className": "col-xs-4  col-sm-3 col-md-3 col-lg-3"},
          {"data": "d", "className": "col-xs-4  col-sm-3 col-md-3 col-lg-2"},
          {"data": "i", "className": "hidden-xs col-sm-2 col-md-1 col-lg-1"}
        ],
        "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {
          $(nRow).addClass('row');
        }
      });
/*      <th class="col-xs-4  col-sm-4 col-md-5 col-lg-6">Subject</th>
      <th class="col-xs-4  col-sm-3 col-md-3 col-lg-3">Author</th>
      <th class="col-xs-4  col-sm-3 col-md-3 col-lg-2">Date</th>
      <th class="hidden-xs col-sm-2 col-md-1 col-lg-1">#</th>*/

      /*// insert 'go-to-message' DOM
      $("div.go-to-message").html(
              "<label>Go to #: " +
              "<input id='select-message' class='form-control input-sm' placeholder='21345'>" +
              "<button class='btn btn-sm btn-primary' onclick='updateSelectMessage()'>Go</button>" +
              "</label>"
      );*/

      /*// select message if specified
      var selectMessage = getParameterByName('select-message');
      if (selectMessage != null) {
        // $("#select-message").val(selectMessage);
        // updateSelectMessage();
        goToMessageNumber(selectMessage);
      }*/

      /*// clicking on table row also selects message
      $("#messages tbody").on('click', 'tr', function () {
        $("#select-message").val($(this).data("message"));
        updateSelectMessage();
      });*/

      // show table
      $('#loading').css('display', 'none');
      $('#table-container').css('display', 'initial');

    });
  </script>
{% endblock %}
